{
  "title": "vue.jsでサブドメインで処理を分ける手法について\n",
  "closed": false,
  "archived": false,
  "created_at": "2021-04-20",
  "comments": [
    {
      "author": "diwamoto",
      "created_at": "2021-04-20",
      "body_markdown": "Vue.jsでSPA運用しているプロジェクトにて、サブドメインで処理を変えたいと思った時の実装方法の検討\n\n### 1. JS側で`var hostStrings = window.location.host.split('.');`とやって一番初めがドメインでなければサブドメインであると判定できる。\n\n利点：\n1. 現行のシステムが既に動いている場合でも、そのコンポーネントを使ってそのまま分岐処理することができる。\n2. 元のコードを弄るのみで解決できる（その他ミドルウェア等の設定が不要）\n\n難点：\n1. 該当ファイルに本来は無駄な分岐処理コードが増えてしまうため、可読性に欠ける\n\n参考:\n [jsでurlを取得](https://lab.syncer.jp/Web/JavaScript/Snippet/20/)\n [js文字列を分割](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/split)\n\n### 2. nginx側で、サブドメインの有無でドキュメントルートを変えて、呼び出すサイトを変えてしまう方法\n\n利点：\n1. 元のSPAのコードを弄る必要がないので(コードの追加は必要だが)、設計が楽\n\n難点：\n1. コードが分かれてしまうので、もし同じ見た目でサブドメインによって処理を分ける場合にはコードのコピーが必要になり、整合性が取れなくなる恐れがある。他に*サブドメインでアクセスしてきた場合のみの処理*を入れてしまうと、とんでもないことになる恐れがある。\n2. nginxの設定が必要(全てのサブドメインでリダイレクト,httpsが必要になる可能性がある)\n\n\n\nまとめ\n動いているシステムに対して行うのであれば1,それ以外の開発中でまだ余裕がある場合は2かなあ。。\n\n\n\n"
    }
  ]
}